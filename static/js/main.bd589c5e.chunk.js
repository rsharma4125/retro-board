(this["webpackJsonpretro-board"]=this["webpackJsonpretro-board"]||[]).push([[0],{248:function(e,t,a){e.exports=a(576)},253:function(e,t,a){},254:function(e,t,a){},291:function(e,t,a){},568:function(e,t,a){},576:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(48),c=a.n(o),s=(a(253),a(10)),l=a(11),i=a(21),u=a(20),d=a(30),m=(a(254),a(18)),p=a(2),f=a.n(p),h=a(8),v=a(98),b=a.n(v),E=function e(){Object(s.a)(this,e),this.uid="",this.idToken="",this.username=void 0,this.displayName="",this.email=""};E.ID_TOKEN="idToken",E.USER_INFO="userInfo",E.REFRESH_TOKEN="refreshToken";var g=E,y=a(227),O=a.n(y),k=new Map;k.set("localhost:3000","localhost:8082"),k.set("192.168.1.6:3000","192.168.1.6:8082"),k.set("localhost:3001","139.59.25.205:8082"),k.set("retro.bemyaficionado.com","139.59.25.205:8082"),k.set("vslala.github.io","139.59.25.205:8082");var w=window.location.host,x="http://"+k.get(w);console.log("SERVICE_URL: ",x);var j=O.a.create({baseURL:x});j.interceptors.request.use((function(e){return e.headers={"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem(g.ID_TOKEN)),Accept:"*/*"},e}));var S={apiKey:"AIzaSyAERXDD08sF5pEmX1j3nlxjiermP5mvVrM",authDomain:"retro-board-ebce6.firebaseapp.com",databaseURL:"https://retro-board-ebce6.firebaseio.com",projectId:"retro-board-ebce6",storageBucket:"retro-board-ebce6.appspot.com",messagingSenderId:"904985549423"},T=(n.a.createContext(null),function(){function e(){Object(s.a)(this,e),this.auth=void 0,this.authenticatedUser=void 0,this.googleAuthenticationProvider=new b.a.auth.GoogleAuthProvider,this.loggedInUser=void 0,b.a.initializeApp(S),this.auth=b.a.auth()}return Object(l.a)(e,[{key:"getDatabase",value:function(){return b.a.database()}},{key:"authenticateUser",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.signInWithPopup(this.googleAuthenticationProvider);case 2:return t=e.sent,e.next=5,this.persistLoggedInUserInfo(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"persistLoggedInUserInfo",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=a.length,n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*r));return t},e.next=3,t.user.getIdToken();case 3:if(r=e.sent,console.log("Logged In User: ",t),!t.user){e.next=15;break}return this.loggedInUser=new g,this.loggedInUser.displayName=t.user.displayName||"".concat(a(5)),this.loggedInUser.idToken=r,this.loggedInUser.email=t.user.email||"".concat(a(5),"@retro.com"),this.loggedInUser.uid=t.user.uid||"",e.next=13,j.post("/login",t.user);case 13:200===e.sent.status&&(localStorage.setItem(g.ID_TOKEN,r),localStorage.setItem(g.USER_INFO,JSON.stringify(this.loggedInUser)),localStorage.setItem(g.REFRESH_TOKEN,t.user.refreshToken));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLoggedInUser",value:function(){var e=localStorage.getItem(g.USER_INFO);if(e)return JSON.parse(e)}},{key:"isUserAuthenticated",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t,a,r,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(g.REFRESH_TOKEN),a=localStorage.getItem(g.ID_TOKEN),!t){e.next=21;break}if(!a){e.next=19;break}return e.next=6,fetch("".concat(x,"/token/verify?id_token=").concat(a));case 6:if(200!==e.sent.status){e.next=11;break}return e.abrupt("return",!0);case 11:return e.next=13,fetch("https://securetoken.googleapis.com/v1/token?key=".concat(S.apiKey),{method:"POST",body:JSON.stringify({grant_type:"refresh_token",refresh_token:t})});case 13:return r=e.sent,e.next=16,r.json();case 16:n=e.sent,localStorage.setItem(g.ID_TOKEN,n.id_token),localStorage.setItem(g.REFRESH_TOKEN,n.refresh_token);case 19:return console.log("User is authenticated!"),e.abrupt("return",!0);case 21:return console.log("User is not authenticated!"),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getIdToken",value:function(){return localStorage.getItem(g.ID_TOKEN)}},{key:"authenticateAnonymousUser",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.auth.signInAnonymously();case 2:return t=e.sent,e.next=5,this.persistLoggedInUserInfo(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){localStorage.clear()}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}());T.instance=void 0;var N,B,I=T,C=a(78),R=function(){return n.a.createElement("footer",{className:"mt-auto font-small blue pt-sm-3"},n.a.createElement("div",{className:"footer-copyright text-center py-1"},n.a.createElement("p",null,n.a.createElement("a",{href:"https://www.bemyaficionado.com"}," a ",n.a.createElement("strong",null,"Varun Shrivastava")," production")),n.a.createElement("p",null,n.a.createElement("strong",null,"TheRetroBoard\xa92020"))))},_=a(99),L=a(247),U=a(38),W=Object(m.f)((function(e){return n.a.createElement(_.a,{bg:"light",expand:"lg"},n.a.createElement(_.a.Brand,{href:"/#/"},"Retro Board"),n.a.createElement(_.a.Toggle,{"aria-controls":"basic-navbar-nav"}),n.a.createElement(_.a.Collapse,{id:"basic-navbar-nav"},n.a.createElement(L.a,{className:"mr-auto"},n.a.createElement(d.b,{className:"nav-link",to:"/"},"Home"),n.a.createElement(d.b,{className:"nav-link",to:"/teams"},"Teams")),n.a.createElement(U.a,{onClick:function(){localStorage.clear(),e.history.push("/login")},variant:"outline-primary"},n.a.createElement("i",{className:"fa fa-sign-out"}))))})),A=a(578),D=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={isUserAuthenticated:!1,isLoading:!0},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;I.getInstance().isUserAuthenticated().then((function(t){e.setState({isUserAuthenticated:t,isLoading:!1})}))}},{key:"render",value:function(){return this.state.isLoading?n.a.createElement(A.a,{animation:"border"}):this.state.isUserAuthenticated?n.a.createElement(C.a,{fluid:!0,className:"d-flex w-100 h-100 p-3 mx-auto flex-column"},n.a.createElement(W,null),this.props.children,n.a.createElement(R,null)):n.a.createElement(m.a,{to:{pathname:"/login",state:{referrer:this.props.location.pathname}}})}}]),a}(n.a.Component),M=Object(m.f)(D),F=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.location,t=e.pathname,a=e.search;return I.getInstance().getLoggedInUser()?t.includes("login")?n.a.createElement(m.a,{to:"/"}):n.a.createElement(m.a,{to:"".concat(t).concat(a)}):n.a.createElement(C.a,{fluid:!0,className:"d-flex w-100 h-100 p-3 mx-auto flex-column"},this.props.children,n.a.createElement(R,null))}}]),a}(n.a.Component),V=Object(m.f)(F),J=a(29),P=a(230),H=a(79),K=a(44),Y=a(13),G={wentWell:{stickyNote:{backgroundColor:"#009688",textColor:"white",likeBtnPosition:"right"}},toImprove:{stickyNote:{backgroundColor:"#e91e63",textColor:"white",likeBtnPosition:"right"}},actionItems:{stickyNote:{backgroundColor:"#9c27b0",textColor:"white",likeBtnPosition:"right"}}},z=function(){function e(t,a,r){Object(s.a)(this,e),this.id=void 0,this.name=void 0,this.maxLikes=void 0,this.blur=void 0,this.userId=void 0,this.id=t,this.name=a,this.maxLikes=5,this.blur="off",this.userId=r}return Object(l.a)(e,null,[{key:"newInstance",value:function(t,a,r){return new e(t,a,r)}},{key:"toJSON",value:function(e){return JSON.stringify(e)}},{key:"fromJSON",value:function(e){return JSON.parse(e)}}]),e}(),q=function(){function e(t){Object(s.a)(this,e),this.retroBoardId="",this.walls=void 0,this.walls=t}return Object(l.a)(e,null,[{key:"toJSON",value:function(e){return JSON.stringify(e)}},{key:"fromJSON",value:function(e){return JSON.parse(e)}}]),e}(),X=function(){function e(t){Object(s.a)(this,e),this._notes=void 0,this._notes=this._removeDuplicates(t)}return Object(l.a)(e,[{key:"notes",get:function(){return Object(K.a)(this._notes)}}]),Object(l.a)(e,[{key:"_removeDuplicates",value:function(e){var t=[];return e.forEach((function(e,a){-1===t.findIndex((function(t){return t.noteId===e.noteId}))&&t.push(e)})),t}}],[{key:"fromJSON",value:function(e){return JSON.parse(e)}},{key:"toJSON",value:function(e){return JSON.stringify(e)}}]),e}();!function(e){e[e.SORT=0]="SORT",e[e.GET_NOTES=1]="GET_NOTES",e[e.RETRIEVE_RETRO_BOARD=2]="RETRIEVE_RETRO_BOARD",e[e.UPDATE_NOTE=3]="UPDATE_NOTE",e[e.DELETE_NOTE=4]="DELETE_NOTE",e[e.CREATE_NOTE=5]="CREATE_NOTE",e[e.CREATE_RETRO_WALLS=6]="CREATE_RETRO_WALLS",e[e.CREATE_RETRO_BOARD=7]="CREATE_RETRO_BOARD",e[e.REFRESH_WALLS=8]="REFRESH_WALLS"}(N||(N={})),function(e){e[e.NONE=0]="NONE",e[e.SORT_BY_VOTES=1]="SORT_BY_VOTES",e[e.SORT_BY_TIMESTAMP=2]="SORT_BY_TIMESTAMP"}(B||(B={}));var Q={retroBoard:new z("","",""),retroWalls:new q([]),notes:new X([])};function Z(e){return new X(e.notes.sort((function(e,t){var a=0,r=0;return e.likedBy&&(a=e.likedBy.length),t.likedBy&&(r=t.likedBy.length),0-(a>r?1:-1)})))}var $=a(231),ee=a(232),te=a.n(ee),ae=Object(P.createLogger)(),re=Object(H.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N.CREATE_RETRO_BOARD:return Object(Y.a)(Object(Y.a)({},e),{},{retroBoard:t.payload});case N.CREATE_RETRO_WALLS:return Object(Y.a)(Object(Y.a)({},e),{},{retroWalls:t.payload});case N.CREATE_NOTE:return Object(Y.a)(Object(Y.a)({},e),{},{notes:new X([].concat(Object(K.a)(e.notes.notes),[t.payload]))});case N.UPDATE_NOTE:var a=e.notes.notes.map((function(e){return e.noteId===t.payload.noteId?Object.assign({},e,t.payload):e}));return Object(Y.a)(Object(Y.a)({},e),{},{notes:new X(a)});case N.DELETE_NOTE:var r=[];return e.notes.notes.forEach((function(e){e.noteId!==t.payload.noteId&&r.push(e)})),Object(Y.a)(Object(Y.a)({},e),{},{notes:new X(r)});case N.GET_NOTES:return console.log("Get Notes: ",t.payload),Object(Y.a)(Object(Y.a)({},e),{},{notes:t.payload});case N.SORT:switch(t.payload){case B.SORT_BY_VOTES:return Object(Y.a)(Object(Y.a)({},e),{},{notes:Z(e.notes)});case B.SORT_BY_TIMESTAMP:return Object(Y.a)({},e);default:return e}case N.REFRESH_WALLS:return Object(Y.a)(Object(Y.a)({},e),{},{retroWalls:t.payload,notes:new X([])})}return Q}),Q,Object($.composeWithDevTools)(Object(H.applyMiddleware)(te.a,ae))),ne=a(233),oe=a(61),ce=a(14),se=a(70),le=function(e){var t=e.retroBoardService,a=Object(r.useState)([]),o=Object(ce.a)(a,2),c=o[0],s=o[1],l=Object(r.useState)(!1),i=Object(ce.a)(l,2),u=i[0],m=i[1];Object(r.useEffect)((function(){function e(){return(e=Object(h.a)(f.a.mark((function e(){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMyBoards();case 2:a=e.sent,s(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){return console.log("User not logged In!",e)}))}),[t]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(ne.a,null,u?n.a.createElement(A.a,{animation:"grow",variant:"danger",style:{position:"absolute",top:"50%",left:"50%"}}):n.a.createElement(n.a.Fragment,null),c.map((function(e,a){return n.a.createElement(oe.a,{lg:"4",key:a},n.a.createElement(se.a,null,n.a.createElement(se.a.Body,null,n.a.createElement("h4",null,e.name)),n.a.createElement(se.a.Footer,null,n.a.createElement(d.b,{to:"/retro-board/".concat(I.getInstance().getLoggedInUser().uid,"/").concat(e.id)},"URL"),n.a.createElement(U.a,{variant:"link",className:"pull-right",onClick:function(){return function(e){m(!0),t.deleteBoard(e).then((function(e){m(!1),s(c.filter((function(t){return t.id!==e})))})).catch((function(e){console.log("Error deleting board! ",e),m(!1)}))}(e)}},n.a.createElement("i",{className:"fa fa-trash-o fa-lg",style:{color:"red"}})))))}))))},ie=a(81),ue=a(234),de=a(64),me=(a(291),a(236)),pe=function(e){var t=Object(r.useState)(!1),a=Object(ce.a)(t,2),n=a[0],o=a[1],c=Object(r.useState)(""),s=Object(ce.a)(c,2),l=s[0],i=s[1],u=function(){e.onSubmit(l),o(!1)};return n?r.createElement(r.Fragment,null,r.createElement(de.a,{onSubmit:function(e){return function(e){e.preventDefault(),u()}(e)}},r.createElement(ue.a,null,r.createElement(de.a.Control,{value:l,onBlur:u,onChange:function(e){return function(e){i(e.currentTarget.value)}(e)}})))):r.createElement(r.Fragment,null,r.createElement(me.a,null,r.createElement("span",{style:{fontSize:"x-large",fontWeight:"bold",marginRight:"5px"}},e.title),r.createElement(U.a,{variant:"light",onClick:function(){return o(!0)}},r.createElement("i",{className:"fa fa-pencil-square-o"}))))},fe=a(579),he=a(126),ve=a(237),be=function(e){var t=Object(r.useState)("#ffffff"),a=Object(ce.a)(t,2),n=a[0],o=a[1];return r.createElement(r.Fragment,null,r.createElement(fe.a,{id:"background_color_picker",title:e.title,variant:"light"},r.createElement(he.a.Item,null,r.createElement(ve.SwatchesPicker,{color:n,onChangeComplete:function(t){o(t),e.handleOnChangeComplete(t)}}))))},Ee=a(22),ge=a(580),ye=a(235),Oe=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={editorText:r.props.noteText?r.props.noteText:""},r.handleKeyboardKeyPress=function(e){"Escape"===e.key&&r.props.handleEnter(r.state.editorText.replace(/\n/g,"")),"Enter"===e.key&&(r.setState({editorText:""}),r.props.handleEnter(r.state.editorText.replace(/\n/g,"")))},r.handleChange=r.handleChange.bind(Object(Ee.a)(r)),r}return Object(l.a)(a,[{key:"handleChange",value:function(e){var t=e.currentTarget.value;this.setState({editorText:t})}},{key:"render",value:function(){var e=this;return n.a.createElement(ge.a,null,n.a.createElement(ye.a,{as:"textarea",autoFocus:!0,"data-testid":"editor_textarea",onKeyUp:this.handleKeyboardKeyPress,onChange:this.handleChange,value:this.state.editorText,"aria-label":"Note Editor",onBlur:function(){return e.props.handleEnter(e.state.editorText.replace(/\n/g,""))}}))}}]),a}(n.a.Component),ke=a(241),we=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={users:r.props.likedBy},r.handleUpVote=r.handleUpVote.bind(Object(Ee.a)(r)),r}return Object(l.a)(a,[{key:"handleUpVote",value:function(e){e.preventDefault();var t=this.getCurrentUser();t&&this.props.handleUpVote(t)}},{key:"getCurrentUser",value:function(){var e=localStorage.getItem(g.USER_INFO);if(e)return JSON.parse(e);console.log("Error: User is not logged in!")}},{key:"render",value:function(){return n.a.createElement("div",{"data-testid":"like_btn",onClick:this.handleUpVote},n.a.createElement(ke.a,{variant:"dark",style:{cursor:"pointer",margin:"0"}},n.a.createElement("span",{"data-testid":"total_votes"},this.props.likedBy.length)),n.a.createElement(se.a.Link,{style:{color:"white"},href:"#"},n.a.createElement("i",{"data-testid":"like_thumbs_up",style:{color:"darkgrey"},className:"fa fa-thumbs-up"})))}}]),a}(n.a.Component),xe=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"createRetroBoard",value:function(e){return{type:N.CREATE_RETRO_BOARD,payload:e}}},{key:"createRetroWalls",value:function(e){return{type:N.CREATE_RETRO_WALLS,payload:e}}},{key:"createNote",value:function(e){return{type:N.CREATE_NOTE,payload:e}}},{key:"updateNote",value:function(e){return{type:N.UPDATE_NOTE,payload:e}}},{key:"deleteNote",value:function(e){return{type:N.DELETE_NOTE,payload:e}}},{key:"getNotes",value:function(e){return{type:N.GET_NOTES,payload:e}}},{key:"sortByVotes",value:function(){return{type:N.SORT,payload:B.SORT_BY_VOTES}}},{key:"sortByTimestamp",value:function(){return{type:N.SORT,payload:B.SORT_BY_TIMESTAMP}}},{key:"refreshRetroWalls",value:function(){return{type:N.REFRESH_WALLS,payload:new q([])}}}]),e}(),je=a(158),Se=a(242),Te=a.n(Se),Ne=a(243),Be=a.n(Ne),Ie=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"connect",value:function(){if(!this.isConnected()&&(e.socket=new Te.a("".concat(x,"/retro-websocket")),e.stomp=Be.a.over(e.socket),!this.isConnected())){var t=localStorage.getItem(g.ID_TOKEN);e.stomp.connect({Authorization:"Bearer "+t},(function(e){console.log("Connected!")}),(function(e){console.log("Connection lost!!! Reload the page...",e)}))}}},{key:"isConnected",value:function(){return e.socket&&e.stomp&&e.stomp.connected}},{key:"subscribe",value:function(t,a){console.log("trying subscribing to topic..."),e.stomp||this.connect();var r=setInterval((function(){e.stomp.connected&&(window.clearInterval(r),e.stomp.subscribe(t,(function(e){a(e)})))}),1e3)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance.isConnected()||e.instance.connect(),e.instance}}]),e}();Ie.instance=void 0,Ie.socket=void 0,Ie.stomp=void 0;var Ce=Ie,Re=function e(t,a,r){Object(s.a)(this,e),this.status=void 0,this.message=void 0,this.name=void 0,this.name=t,this.status=r,this.message=a},_e=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"addNewNote",value:function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.post("/retro-board/walls/notes",t);case 2:if(201!==e.sent.status){e.next=5;break}return e.abrupt("return",t);case 5:throw Error("Error creating note in the backend!");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createNewRetroBoard",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a,r,n,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.title,r=t.maxLikes,e.next=3,I.getInstance().isUserAuthenticated();case 3:if(e.sent){e.next=6;break}throw Error("Authentication Exception! User is not logged in.");case 6:return e.next=8,j.post("/retro-board",{name:a,maxLikes:r});case 8:if(201!==(n=e.sent).status){e.next=19;break}return console.log(n),console.log(n.headers.location),e.next=14,j.get(n.headers.location);case 14:return o=e.sent,e.next=17,o.data;case 17:return c=e.sent,e.abrupt("return",c);case 19:throw Error("Error creating RetroBoard in the backend!");case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createRetroWalls",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r,n,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.get("/retro-board/walls/".concat(t));case 3:if(200!==(r=e.sent).status){e.next=8;break}return e.next=7,r.data;case 7:return e.abrupt("return",e.sent);case 8:e.next=24;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log("Creating Retro Walls!"),a.retroBoardId=t,e.next=16,j.post("/retro-board/walls",a);case 16:if(201!==(n=e.sent).status){e.next=24;break}return e.next=20,j.get(n.headers.location);case 20:return o=e.sent,e.next=23,o.data;case 23:return e.abrupt("return",e.sent);case 24:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"deleteBoard",value:function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.delete("/retro-board/".concat(t.id));case 2:if(204!==e.sent.status){e.next=5;break}return e.abrupt("return",t.id);case 5:throw Error("Error deleting retro board in the backend!");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteNote",value:function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.delete("/retro-board/walls/notes",{params:{noteId:t.noteId,retroBoardId:t.retroBoardId}});case 2:if(204!==e.sent.status){e.next=5;break}return e.abrupt("return",t);case 5:throw Error("Error deleting note at the backend!");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDataOnUpdate",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a,r){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ce.getInstance().subscribe("/topic/notes/".concat(t),function(){var e=Object(h.a)(f.a.mark((function e(n){var o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/retro-board/walls/notes",{params:{retroBoardId:t,wallId:a}});case 2:return o=e.sent,e.t0=r,e.next=6,o.data;case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,j.get("/retro-board/walls/notes",{params:{retroBoardId:t,wallId:a}});case 4:return n=e.sent,e.t0=r,e.next=8,n.data;case 8:e.t1=e.sent,(0,e.t0)(e.t1);case 10:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"getMyBoards",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getInstance().isUserAuthenticated();case 2:if(t=e.sent,console.log("IsUserAuthenticated: "+t),!t){e.next=12;break}return e.next=7,j.get("/retro-board");case 7:if(200!==(a=e.sent).status){e.next=12;break}return e.next=11,a.data;case 11:return e.abrupt("return",e.sent);case 12:throw Error("Error encountered while fetching boards for the user");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getNoteWhenLiked",value:function(e,t){return Promise.resolve()}},{key:"getNotes",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/retro-board/walls/notes/".concat(t));case 2:if(200!==(r=e.sent).status){e.next=8;break}return e.next=6,r.data;case 6:return n=e.sent,e.abrupt("return",n);case 8:throw Error("Encountered Error while trying to fetch notes for ".concat(t," > ").concat(a));case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getRetroBoardById",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/retro-board/".concat(a));case 2:if(200!==(r=e.sent).status){e.next=10;break}return e.next=6,r.data;case 6:return n=e.sent,e.abrupt("return",n);case 10:if(401!==r.status){e.next=12;break}throw new Re("Unauthorized","User is not authorized to view the contents of this board.",401);case 12:throw Error("Error encountered while fetching retro board from the server");case 13:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getRetroBoardDataOnUpdate",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(new Ce).subscribe("/topic/retro-board/".concat(a),function(){var e=Object(h.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("URI : ",t),e.next=3,j.get(t.body);case 3:if(200!==(a=e.sent).status){e.next=10;break}return e.t0=r,e.next=8,a.data;case 8:e.t1=e.sent,(0,e.t0)(e.t1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"getRetroWalls",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/retro-board/walls/".concat(t));case 2:if(200!==(a=e.sent).status){e.next=8;break}return e.next=6,a.data;case 6:return r=e.sent,e.abrupt("return",r);case 8:throw Error("Error encountered while fetching retro walls for retro board (".concat(t,")"));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"sortByVotes",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.notes.sort((function(e,t){return e.likedBy.length-t.likedBy.length})),e.abrupt("return",new X(a));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateNote",value:function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.put("/retro-board/walls/notes",t);case 2:if(204!==e.sent.status){e.next=5;break}return e.abrupt("return",t);case 5:throw Error("Error encountered while updating note in the backend.");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRetroBoard",value:function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.put("/retro-board",t);case 2:if(204!==e.sent.status){e.next=5;break}return e.abrupt("return",t);case 5:throw Error("Error encountered while updating note in the backend.");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareBoard",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.post("/share",{itemId:t,teamIds:a.map((function(e){return e.teamId}))});case 2:if(201!==e.sent.status){e.next=5;break}return e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return this.retroBoardService||(this.retroBoardService=new e),this.retroBoardService}}]),e}();_e.retroBoardService=void 0;var Le=_e,Ue=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"getInstance",value:function(){return Le.getInstance()}}]),e}(),We=a(157),Ae=a.n(We),De=(a(568),function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={showToast:!1,toastMessage:"",stickyNoteId:r.props.note.noteId,showEditor:!1,noteText:r.props.note.noteText,likedBy:r.props.note.likedBy},r.handleOnClick=r.handleOnClick.bind(Object(Ee.a)(r)),r.modifyStickyNote=r.modifyStickyNote.bind(Object(Ee.a)(r)),r.handleUpVote=r.handleUpVote.bind(Object(Ee.a)(r)),r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.note;this.props.retroBoardService.getNoteWhenLiked(t,(function(t){t&&e.props.updateNote(t)}))}},{key:"handleOnClick",value:function(){if(console.log("Condition: ",this.props.note.createdBy.includes(I.getInstance().getLoggedInUser().uid)),console.log("".concat(this.props.note.createdBy," === ").concat(I.getInstance().getLoggedInUser().uid)),this.props.note.createdBy.includes(I.getInstance().getLoggedInUser().uid)){var e=this.state.noteText;this.setState({showEditor:!0,noteText:e})}}},{key:"modifyStickyNote",value:function(e){this.setState({showEditor:!1,noteText:e.noteText}),this.props.updateNote(e)}},{key:"_getTotalLikesForUser",value:function(e){var t=0;return this.props.notes.notes.forEach((function(a){a.likedBy&&a.likedBy.some((function(t){return t.uid===e.uid}))&&t++})),t}},{key:"handleUpVote",value:function(e){var t,a=this,r=(null===(t=this.props.note)||void 0===t?void 0:t.likedBy)||[],n=r.filter((function(t){return t.email===e.email})).length>0,o=this._getTotalLikesForUser(e),c=this.props.retroBoard.maxLikes;if(!n&&o<c){r.push(e),this.setState({likedBy:r});var s=this.props.note;s.likedBy=r,this.props.updateNote(s).then((function(){a.props.sortBy===B.SORT_BY_VOTES&&a.props.sortByVotes()}))}else this.setState({showToast:!0,toastMessage:"Like Count Limit Reached"}),setTimeout((function(){a.setState({showToast:!1})}),2e3)}},{key:"_mergeNoteIfRequired",value:function(e){var t="on"!==this.props.retroBoard.blur||e.createdBy.includes(I.getInstance().getLoggedInUser().uid)?"blur(0px)":"blur(3px)",a=n.a.createElement("div",{className:"card-text",style:{width:"95%",filter:t}},n.a.createElement(Ae.a,{source:e.noteText,escapeHtml:!0}));if(e.noteText.includes("  ")){var r=e.noteText.split("  ").map((function(e,t){return n.a.createElement("div",{key:t},n.a.createElement(Ae.a,{source:e,escapeHtml:!0}),n.a.createElement("hr",null))}));a=n.a.createElement("div",{className:"card-text",style:{width:"95%",filter:t}},r)}return a}},{key:"render",value:function(){var e,t,a=this,r=this.props.note,o=this._mergeNoteIfRequired(r);return n.a.createElement(se.a,{className:"sticky-note z-depth-5",style:{backgroundColor:(null===(e=r.style)||void 0===e?void 0:e.backgroundColor)||"white"}},n.a.createElement(se.a.Body,{"data-testid":"card_body",style:{padding:"5px",fontFamily:"sans-serif",fontWeight:500,minHeight:"50px"},onClick:this.handleOnClick},n.a.createElement("div",{"data-testid":"editor",style:{color:(null===(t=r.style)||void 0===t?void 0:t.textColor)||"black"}},this.state.showEditor?n.a.createElement(Oe,{noteText:r.noteText,handleEnter:function(e){return a.modifyStickyNote(Object(Y.a)(Object(Y.a)({},r),{},{noteText:e}))}}):o)),n.a.createElement("ul",{className:"list-inline pull-right",style:{position:"absolute",right:"5px",bottom:"0px"}},n.a.createElement("li",{className:"list-inline-item"},n.a.createElement(we,{key:"like_note.noteId",handleUpVote:this.handleUpVote,likedBy:r.likedBy||[],stickyNoteId:r.noteId})),n.a.createElement("li",{className:"list-inline-item"},n.a.createElement(ke.a,{"data-testid":"delete_badge_".concat(r.noteId),variant:"danger",style:{cursor:"pointer",padding:"2px",margin:"0"},onClick:function(){return a.props.deleteNote(r)}},n.a.createElement("i",{className:"fa fa-trash-o"})))),n.a.createElement(je.a,{"data-testid":"toast",show:this.state.showToast,style:{position:"absolute",left:"50%"}},n.a.createElement(je.a.Body,null,this.state.toastMessage)))}}]),a}(n.a.Component)),Me=Object(J.b)((function(e){return{retroBoard:e.retroBoard,retroWalls:e.retroWalls,notes:e.notes}}),(function(e){var t=Ue.getInstance(),a=new xe;return{updateNote:function(){var r=Object(h.a)(f.a.mark((function r(n){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.t1=a,r.next=4,t.updateNote(n);case 4:return r.t2=r.sent,r.t3=r.t1.updateNote.call(r.t1,r.t2),r.abrupt("return",(0,r.t0)(r.t3));case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),deleteNote:function(){var r=Object(h.a)(f.a.mark((function r(n){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.t1=a,r.next=4,t.deleteNote(n);case 4:return r.t2=r.sent,r.t3=r.t1.deleteNote.call(r.t1,r.t2),r.abrupt("return",(0,r.t0)(r.t3));case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),sortByVotes:function(){var t=Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(a.sortByVotes()));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}))(De),Fe=function(){function e(t,a,r,n){Object(s.a)(this,e),this.retroBoardId=void 0,this.wallId=void 0,this.noteId=void 0,this.noteText=void 0,this.style=void 0,this.likedBy=void 0,this.createdBy=void 0,this.retroBoardId=t,this.wallId=a,this.noteId=String(Date.now()),this.noteText=r,this.style=n,this.likedBy=[],this.createdBy=""}return Object(l.a)(e,null,[{key:"toJSON",value:function(e){return JSON.stringify(e)}},{key:"fromJSON",value:function(e){return JSON.parse(e)}}]),e}(),Ve=function(e){var t=e.boardTemplate,a=e.removeWall;return r.createElement(r.Fragment,null,r.createElement(ne.a,null,t.walls.map((function(e,t){var n;return r.createElement(oe.a,{key:t,className:"justify-content-center text-center"},r.createElement("h6",null,e.wallTitle," ",r.createElement(U.a,{onClick:function(){return a(t)},variant:"link"},r.createElement("i",{className:"fa fa-times"}))),(null===e||void 0===e||null===(n=e.notes)||void 0===n?void 0:n.length)>0?e.notes.map((function(e,t){return r.createElement(Me,{key:t,note:new Fe("","",e.noteText,e.noteStyle),sortBy:B.NONE,retroBoardService:Ue.getInstance()})})):r.createElement(Me,{key:t,note:new Fe("","","Foo Bar",e.wallStyle.stickyNote),sortBy:B.NONE,retroBoardService:Ue.getInstance()}))}))))},Je=function(e){var t,a=Object(r.useState)(!1),n=Object(ce.a)(a,2),o=n[0],c=n[1],s=function(){return c(!1)},l=Object(r.useState)({templateTitle:"Template Title",walls:[],templateId:"",userId:null===(t=I.getInstance().getLoggedInUser())||void 0===t?void 0:t.uid}),i=Object(ce.a)(l,2),u=i[0],d=i[1],m=Object(r.useState)(""),p=Object(ce.a)(m,2),f=p[0],h=p[1],v=Object(r.useState)("#ffffff"),b=Object(ce.a)(v,2),E=b[0],g=b[1],y=Object(r.useState)(G.wentWell.stickyNote.backgroundColor),O=Object(ce.a)(y,2),k=O[0],w=O[1];return r.createElement(r.Fragment,null,r.createElement(U.a,{variant:"light",onClick:function(){return c(!0)},style:{padding:"25px",border:"2px dashed"}},r.createElement("i",{className:"fa fa-plus fa-lg"})),r.createElement(ie.a,{show:o,onHide:s,dialogClassName:"custom-modal"},r.createElement(ie.a.Header,null,r.createElement(pe,{onSubmit:function(e){return t=e,void d(Object(Y.a)(Object(Y.a)({},u),{},{templateTitle:t}));var t},title:u.templateTitle})),r.createElement(ie.a.Body,null,r.createElement(ne.a,null,r.createElement(ue.a,null,r.createElement(ne.a,null,r.createElement(de.a,{inline:!0,onSubmit:function(e){return e.preventDefault()}},r.createElement(oe.a,null,r.createElement(de.a.Control,{placeholder:"Wall Title",onChange:function(e){return function(e){return h(e.currentTarget.value)}(e)},value:f,style:{padding:"20px",marginLeft:"5px"}})),r.createElement(oe.a,{style:{backgroundColor:E}},r.createElement(be,{title:"Text Color",handleOnChangeComplete:function(e){return g(e.hex)}})),r.createElement(oe.a,{style:{backgroundColor:k}},r.createElement(be,{title:"Background Color",handleOnChangeComplete:function(e){return w(e.hex)}})),r.createElement(oe.a,null,r.createElement(U.a,{onClick:function(){var e={wallTitle:f,wallStyle:{stickyNote:{backgroundColor:k,textColor:E,likeBtnPosition:"right"}},wallOrder:1,notes:[{noteText:"Lorem Epsum Dolor Sit amet",noteStyle:{backgroundColor:k,textColor:E,likeBtnPosition:"right"}}]};d(Object(Y.a)(Object(Y.a)({},u),{},{walls:[].concat(Object(K.a)(u.walls),[e])})),h("")},disabled:""===f},"Add Wall"))),r.createElement("hr",null)))),r.createElement("div",{style:{border:"1px solid",padding:"20px",margin:"1px solid"}},r.createElement(Ve,{boardTemplate:u,removeWall:function(e){d(Object(Y.a)(Object(Y.a)({},u),{},{walls:[].concat(Object(K.a)(u.walls.slice(0,e)),Object(K.a)(u.walls.slice(e+1)))}))}}))),r.createElement(ie.a.Footer,null,r.createElement(U.a,{variant:"success",disabled:0===u.walls.length,onClick:function(){var t=Object(Y.a)(Object(Y.a)({},u),{},{walls:u.walls.map((function(e,t){return Object(Y.a)(Object(Y.a)({},e),{},{wallOrder:t})}))});e.onCreateTemplate(t),s()}},"Create Template"),r.createElement(U.a,{variant:"light",onClick:s},"Cancel"))))},Pe=a(122),He=function(e){var t=e.onCreateRetroBoard,a=e.title,o=Object(r.useState)(!1),c=Object(ce.a)(o,2),s=c[0],l=c[1],i=Object(r.useState)({title:"",maxLikes:5}),u=Object(ce.a)(i,2),d=u[0],m=u[1],p=function(){return l(!1)},v=function(e){return function(t){var a=t.currentTarget.value;m(Object(Y.a)(Object(Y.a)({},d),{},Object(Pe.a)({},e,a)))}},b=function(){var e=Object(h.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(d),p();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.createElement(n.a.Fragment,null,n.a.createElement(U.a,{variant:"outline-primary",onClick:function(){return l(!0)}},a),n.a.createElement(ie.a,{show:s,onHide:p},n.a.createElement(ie.a.Header,{closeButton:!0},n.a.createElement(ie.a.Title,null,a)),n.a.createElement(ie.a.Body,null,n.a.createElement(de.a,null,n.a.createElement(de.a.Group,null,n.a.createElement(de.a.Label,null,"Dashboard Title"),n.a.createElement(de.a.Control,{name:"title",type:"text",placeholder:"e.g. Spring 400 ",value:d.title,autoComplete:"false",onChange:v("title")})),n.a.createElement(de.a.Group,null,n.a.createElement(de.a.Label,null,"Max Likes"),n.a.createElement(de.a.Control,{name:"maxLikes",type:"number",placeholder:"e.g. 5 or 6 ",onChange:v("maxLikes"),autoComplete:"false",value:String(d.maxLikes)})))),n.a.createElement(ie.a.Footer,null,n.a.createElement(U.a,{variant:"secondary",onClick:p},"Close"),n.a.createElement(U.a,{variant:"primary",onClick:b},"Save Changes"))))},Ke=function(){function e(t,a,r){Object(s.a)(this,e),this.retroBoardId=void 0,this.wallId=void 0,this.title=void 0,this.style=void 0,this.sortCards=void 0,this.wallOrder=1,this.retroBoardId=t,this.wallId=a.replace(/\s/g,""),this.title=a,this.style=r,this.sortCards=!1}return Object(l.a)(e,[{key:"setWallOrder",value:function(e){return this.wallOrder=e,this}}],[{key:"newInstance",value:function(t,a,r){return new e(t,a,r)}}]),e}(),Ye=Object(m.f)((function(e){var t=Object(J.c)(),a=function(){var a=Object(h.a)(f.a.mark((function a(r){var n,o,c;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=new xe,a.next=3,e.retroBoardService.createNewRetroBoard(r);case 3:return o=a.sent,t(n.createRetroBoard(o)),console.log("Template Walls -> ",e.templateWalls),a.next=8,e.retroBoardService.createRetroWalls(o.id,new q(e.templateWalls.map((function(e,t){return Ke.newInstance(o.id,e.wallTitle,e.wallStyle).setWallOrder(e.wallOrder)}))));case 8:c=a.sent,e.history.push({pathname:"/retro-board/".concat(o.userId,"/").concat(o.id),state:{walls:new q(c)}});case 10:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return r.createElement(r.Fragment,null,r.createElement(He,{title:e.title,onCreateRetroBoard:a}))})),Ge=Object(m.f)((function(e){var t=Object(r.useState)([]),a=Object(ce.a)(t,2),n=a[0],o=a[1],c=function(){var t=Object(h.a)(f.a.mark((function t(a){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.templateService.createBoardTemplate(a);case 2:r=t.sent,o([].concat(Object(K.a)(n),[r]));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s=function(){var t=Object(h.a)(f.a.mark((function t(a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.templateService.deleteBoardTemplate(a);case 2:o(n.filter((function(e){return e.templateId!==a.templateId})));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(r.useEffect)((function(){e.templateService.getBoardTemplates().then((function(e){o(e.templates)}))}),[e.templateService]),r.createElement(r.Fragment,null,r.createElement(ne.a,null,r.createElement(oe.a,{md:1},r.createElement(Je,{onCreateTemplate:c})),n.map((function(t,a){return r.createElement(oe.a,{key:a,md:3},r.createElement(se.a,null,r.createElement(se.a.Body,null,r.createElement("div",{key:a},r.createElement(se.a.Title,null,t.templateTitle),r.createElement(Ve,{boardTemplate:t,removeWall:function(e){return console.log("Test Button Clicked!")}}))),r.createElement(se.a.Footer,null,r.createElement(Ye,{title:"Create Board",retroBoardService:e.retroBoardService,templateWalls:t.walls}),r.createElement(U.a,{className:"pull-right",variant:"light",onClick:function(){return s(t)}},r.createElement("i",{className:"fa fa-trash-o fa-lg",style:{color:"red"}})))))}))))})),ze=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){document.title="Home"}},{key:"render",value:function(){return n.a.createElement(C.a,null,n.a.createElement(ne.a,null,n.a.createElement(oe.a,null,n.a.createElement("div",{className:"pb-2 mt-4 mb-2 border-bottom"},n.a.createElement("h3",null,"Pre-built Templates")),n.a.createElement(Ye,{title:"Create Retro Board",retroBoardService:this.props.retroBoardService,templateWalls:[{wallTitle:"Went Well",wallStyle:G.wentWell,wallOrder:1,notes:[]},{wallTitle:"To Improve",wallStyle:G.toImprove,wallOrder:2,notes:[]},{wallTitle:"Action Items",wallStyle:G.actionItems,wallOrder:3,notes:[]}]}))),n.a.createElement(ne.a,null,n.a.createElement(oe.a,null,n.a.createElement("div",{className:"pb-2 mt-4 mb-2 border-bottom"},n.a.createElement("h3",null,"My Templates")),n.a.createElement(Ge,{retroBoardService:this.props.retroBoardService,templateService:this.props.templateService}))),n.a.createElement(ne.a,null,n.a.createElement(oe.a,null,n.a.createElement("div",{className:"pb-2 mt-4 mb-2 border-bottom"},n.a.createElement("h3",null,"My Boards")),n.a.createElement(le,{retroBoardService:this.props.retroBoardService}))))}}]),a}(n.a.Component),qe=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={showEditor:!1},r.showEditor=r.showEditor.bind(Object(Ee.a)(r)),r.handleEnter=r.handleEnter.bind(Object(Ee.a)(r)),r}return Object(l.a)(a,[{key:"showEditor",value:function(){this.setState({showEditor:!0})}},{key:"handleEnter",value:function(e){""!==e&&(this.props.addNote(e),this.setState({showEditor:!1}))}},{key:"render",value:function(){return this.state.showEditor?n.a.createElement("div",{style:{margin:"5px"}},n.a.createElement(Oe,{handleEnter:this.handleEnter})):n.a.createElement("div",{style:{margin:"5px"}},n.a.createElement(U.a,{title:"Add new note","data-testid":"add_new_note_btn",variant:"dark",onClick:this.showEditor},n.a.createElement("i",{className:"fa fa-lg fa-plus"})))}}]),a}(n.a.Component),Xe=a(245),Qe=a(581),Ze=a(584),$e=function(e){var t=Object(r.useState)(!1),a=Object(ce.a)(t,2),n=a[0],o=a[1],c=Object(r.useState)(0),s=Object(ce.a)(c,2),l=s[0],i=s[1];return r.createElement(r.Fragment,null,r.createElement("div",{style:{margin:"5px"}},r.createElement(U.a,{title:"Retrospect",variant:"link",onClick:function(){return o(!0)}},r.createElement("i",{className:"fa fa-lg fa-eye"}))),r.createElement(r.Fragment,null,r.createElement(ie.a,{show:n,onHide:function(){return o(!1)},style:{backgroundColor:"black"}},r.createElement(ie.a.Body,{style:{backgroundColor:e.style.backgroundColor}},r.createElement(Ze.a,{activeIndex:l,onSelect:function(e){return i(e)},interval:null},e.items.map((function(t,a){return r.createElement(Ze.a.Item,{key:a},r.createElement("div",{style:{height:"400px"}},r.createElement(Ze.a.Caption,{style:{color:e.style.textColor}},r.createElement("div",{style:{height:"200px",overflowY:"scroll"}},r.createElement("h3",{style:{overflowY:"scroll"}},function(e){return e.includes("<MERGE_NOTE>")?e.split("<MERGE_NOTE>").map((function(e,t){return r.createElement("span",{key:t},e,r.createElement("br",null),r.createElement("hr",{style:{borderTop:"1px dashed"}}))})):r.createElement("span",null,e)}(t))))))})))))))},et=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).retroWall=void 0,r.state={notes:[]},r.addNote=r.addNote.bind(Object(Ee.a)(r)),r.retroWall=e.retroWall,r.handleDragStart=r.handleDragStart.bind(Object(Ee.a)(r)),r.handleDrop=r.handleDrop.bind(Object(Ee.a)(r)),r.handleDragOver=r.handleDragOver.bind(Object(Ee.a)(r)),r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.getNotes(this.retroWall.retroBoardId,this.retroWall.wallId),this.props.retroBoardService.getDataOnUpdate(this.retroWall.retroBoardId,this.retroWall.wallId,(function(){console.log("Data Changed!"),e.props.getNotes(e.retroWall.retroBoardId,e.retroWall.wallId)}))}},{key:"addNote",value:function(e){var t,a,r,n,o,c,s=this,l=new Fe(this.retroWall.retroBoardId,this.retroWall.wallId,e,{backgroundColor:(null===(t=this.retroWall.style)||void 0===t||null===(a=t.stickyNote)||void 0===a?void 0:a.backgroundColor)||"white",textColor:(null===(r=this.retroWall.style)||void 0===r||null===(n=r.stickyNote)||void 0===n?void 0:n.textColor)||"black",likeBtnPosition:(null===(o=this.retroWall.style)||void 0===o||null===(c=o.stickyNote)||void 0===c?void 0:c.likeBtnPosition)||"right"});l.createdBy=I.getInstance().getLoggedInUser().email,this.props.addNewNote(l).then((function(){s.props.sortByVotes()}))}},{key:"handleDrop",value:function(e,t){var a=this,r=JSON.parse(e.dataTransfer.getData("text/plain"));r.noteId!==t.noteId&&(t.noteText+="  "+r.noteText,this.props.updateNote(Object(Y.a)({},t)).then((function(){a.props.deleteNote(r)})))}},{key:"handleDragOver",value:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}},{key:"handleDragStart",value:function(e,t){e.dataTransfer.setData("text/plain",JSON.stringify(t))}},{key:"render",value:function(){var e,t,a=this,r=this.props.notes.filter((function(e){return e.wallId===a.retroWall.wallId})),o=r.map((function(e,t){return n.a.createElement(Xe.a,{key:t,style:{padding:"0px",border:"none",marginBottom:"2px"},className:"text-left",id:"list_group_item_".concat(t),draggable:!0,onDragStart:function(t){return a.handleDragStart(t,e)},onDragOver:a.handleDragOver,onDrop:function(t){return a.handleDrop(t,e)}},n.a.createElement(Me,{key:e.noteId,note:e,retroBoardService:a.props.retroBoardService,sortBy:a.props.sortBy}))}));return n.a.createElement("section",{className:"sticky-wall text-center"},n.a.createElement("h3",null,this.retroWall.title," "),n.a.createElement(ne.a,null,n.a.createElement(oe.a,null,n.a.createElement($e,{items:r.map((function(e){return e.noteText})),style:{textColor:null===(e=r[0])||void 0===e?void 0:e.style.textColor,backgroundColor:null===(t=r[0])||void 0===t?void 0:t.style.backgroundColor}}))),n.a.createElement(qe,{addNote:this.addNote}),n.a.createElement(Qe.a,null,o))}}]),a}(r.Component),tt=Object(J.b)(null,(function(e){var t=Ue.getInstance(),a=new xe;return{addNewNote:function(){var r=Object(h.a)(f.a.mark((function r(n){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.t1=a,r.next=4,t.addNewNote(n);case 4:return r.t2=r.sent,r.t3=r.t1.createNote.call(r.t1,r.t2),r.abrupt("return",(0,r.t0)(r.t3));case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),updateNote:function(){var r=Object(h.a)(f.a.mark((function r(n){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.t1=a,r.next=4,t.updateNote(n);case 4:return r.t2=r.sent,r.t3=r.t1.updateNote.call(r.t1,r.t2),r.abrupt("return",(0,r.t0)(r.t3));case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),deleteNote:function(){var r=Object(h.a)(f.a.mark((function r(n){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.t1=a,r.next=4,t.deleteNote(n);case 4:return r.t2=r.sent,r.t3=r.t1.deleteNote.call(r.t1,r.t2),r.abrupt("return",(0,r.t0)(r.t3));case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),getNotes:function(){var r=Object(h.a)(f.a.mark((function r(n,o){return f.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.t1=a,r.next=4,t.getNotes(n,o);case 4:return r.t2=r.sent,r.t3=r.t1.getNotes.call(r.t1,r.t2),r.abrupt("return",(0,r.t0)(r.t3));case 7:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),sortByVotes:function(){var t=Object(h.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e(a.sortByVotes()));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}))(et),at=a(246),rt=a(582),nt=a(583),ot=function(e){var t=e.teams?e.teams:[],a=Object(r.useState)(!1),n=Object(ce.a)(a,2),o=n[0],c=n[1],s=function(){return c(!1)},l=Object(r.useState)(!1),i=Object(ce.a)(l,2),u=i[0],d=i[1],m=Object(r.useState)([]),p=Object(ce.a)(m,2),v=p[0],b=p[1],E=Object(r.useState)(void 0),g=Object(ce.a)(E,2),y=g[0],O=g[1],k=function(){var t=Object(h.a)(f.a.mark((function t(){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d(!0),t.next=3,e.shareWith(v);case 3:a=t.sent,O(!0===a?r.createElement(rt.a,{variant:"success"},r.createElement("i",{className:"fa fa-check",style:{color:"green"}}),"Page is now shared with the selected teams."):r.createElement(rt.a,{variant:"danger"},"Cannot share the page. Contact admin.")),d(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.createElement(r.Fragment,null,r.createElement(U.a,{style:{border:"1px solid black"},variant:"light",onClick:function(){return c(!0)}},r.createElement("i",{className:"fa fa-share-alt"})),r.createElement(ie.a,{show:o,onHide:s},r.createElement(ie.a.Body,null,r.createElement(de.a,{onSubmit:k},r.createElement(ue.a,null,r.createElement(de.a.Label,null,r.createElement("h3",null,"Share with:")),r.createElement(de.a.Control,{as:"select",multiple:!0,onChange:function(t){return function(t){for(var a=t.currentTarget.selectedOptions,r=[],n=function(t){r.push(e.teams.find((function(e){return e.teamId===a[t].value})))},o=0;o<a.length;o++)n(o);b(r)}(t)}},r.createElement("option",{disabled:!0},"Select teams to share"),t.map((function(e,t){return r.createElement("option",{key:t,value:e.teamId},e.teamName)})))),r.createElement(ue.a,null,r.createElement(U.a,{type:"submit",variant:"success"},"Share"),r.createElement(U.a,{onClick:s,variant:"light"},"Cancel")))),u?r.createElement(ie.a.Footer,null,u?r.createElement(r.Fragment,null,r.createElement(nt.a,{animated:!0}),y):r.createElement(r.Fragment,null,y)):r.createElement(r.Fragment,null,y)))},ct=function(){var e=new xe,t=Object(J.c)(),a=Object(r.useState)(B.NONE),o=Object(ce.a)(a,2),c=o[0],s=o[1];return n.a.createElement(de.a,null,n.a.createElement(de.a.Group,null,n.a.createElement(de.a.Label,null,"Sort cards: "),n.a.createElement(ye.a,{as:"select",onChange:function(a){a.target.value===String(B.SORT_BY_VOTES)&&(t(e.sortByVotes()),s(B.SORT_BY_VOTES))},"data-testid":"sort_select",value:String(c)},n.a.createElement("option",{defaultValue:String(B.NONE)},"select..."),n.a.createElement("option",{defaultValue:String(B.SORT_BY_VOTES),value:B.SORT_BY_VOTES},"Sort by Up-votes"))))},st=function(e){var t=(0,J.d)((function(e){return e})),a=new xe,r=Object(J.c)();if(e.retroBoard.userId!==I.getInstance().getLoggedInUser().uid)return n.a.createElement(n.a.Fragment,null);var o=function(){var n=Object(h.a)(f.a.mark((function n(o){var c;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("Value: ",o),(c=Object(Y.a)({},t.retroBoard)).blur=o,n.t0=r,n.t1=a,n.next=7,e.retroBoardService.updateRetroBoard(c);case 7:n.t2=n.sent,n.t3=n.t1.createRetroBoard.call(n.t1,n.t2),(0,n.t0)(n.t3);case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),c="on"===e.retroBoard.blur;return n.a.createElement(ge.a,{className:"pull-right"},n.a.createElement(de.a.Check,{checked:c,type:"switch",id:"switch_on",label:"Blur On",onChange:function(){return o(c?"off":"on")}}))},lt=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={retroBoardId:"",sortSelectValue:B.NONE,teams:[]},r.convertJsonToCsv=r.convertJsonToCsv.bind(Object(Ee.a)(r)),r.shareBoardWith=r.shareBoardWith.bind(Object(Ee.a)(r)),r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.retroBoardId,a=e.uid;localStorage.setItem("retroBoardId",t),t&&a&&this.initRetroBoard(t,a)}},{key:"initRetroBoard",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r,n,o=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setState({retroBoardId:t}),e.t0=this,e.next=5,this.props.teamsService.getMyTeams();case 5:return e.t1=e.sent,e.t2={teams:e.t1},e.t0.setState.call(e.t0,e.t2),e.next=10,this.props.retroBoardService.getRetroBoardById(a,t);case 10:return r=e.sent,document.title=r.name,e.next=14,this.props.createRetroBoard(r);case 14:return e.next=16,this.props.retroBoardService.getRetroWalls(t);case 16:return n=e.sent,e.next=19,this.props.createRetroWalls(n);case 19:this.props.retroBoardService.getRetroBoardDataOnUpdate(a,t,(function(e){console.log("RetroBoard: ",e),o.props.createRetroBoard(e)})),e.next=25;break;case 22:e.prev=22,e.t3=e.catch(0),e.t3 instanceof Re&&this.props.history.push("/unauthorized");case 25:case"end":return e.stop()}}),e,this,[[0,22]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"convertJsonToCsv",value:function(){var e=[],t=this.props,a=t.notes;return t.retroWalls.walls.forEach((function(t){a.notes.forEach((function(a){var r;a.wallId===t.wallId&&e.push({wallName:t.title,noteText:a.noteText,upvotes:(null===(r=a.likedBy)||void 0===r?void 0:r.length)||0})}))})),{data:e,headers:[{label:"Wall Name",key:"wallName"},{label:"Note",key:"noteText"},{label:"Up-votes",key:"upvotes"}]}}},{key:"shareBoardWith",value:function(){var e=Object(h.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.retroBoardService.shareBoard(this.state.retroBoardId,t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.match.params.retroBoardId,a=this.props.retroWalls.walls.map((function(a,r){return a.retroBoardId=t,n.a.createElement(oe.a,{key:r},n.a.createElement(tt,{retroBoardService:e.props.retroBoardService,retroWall:a,notes:e.props.notes.notes,sortBy:e.state.sortSelectValue}))}));return n.a.createElement("div",{style:{padding:"50px"}},n.a.createElement(ne.a,null,n.a.createElement(oe.a,null,n.a.createElement(ct,null)),n.a.createElement(oe.a,{className:"align-self-center"},n.a.createElement(st,this.props)),n.a.createElement(oe.a,{className:"align-self-center"},n.a.createElement("div",{className:"pull-right"},n.a.createElement(ot,{teams:this.state.teams,shareWith:this.shareBoardWith})),n.a.createElement(U.a,{className:"pull-right",style:{border:"1px solid black"},variant:"light"},n.a.createElement(at.CSVLink,Object.assign({},this.convertJsonToCsv(),{target:"_blank",filename:this.props.retroBoard.name}),n.a.createElement("i",{className:"fa fa-file-excel-o",style:{color:"blue"}}))))),n.a.createElement(ne.a,null,a))}}]),a}(n.a.Component);var it=Object(J.b)((function(e){return{retroBoard:e.retroBoard,retroWalls:e.retroWalls,notes:e.notes}}),(function(e){var t=new xe;return{createRetroWalls:function(){var a=Object(h.a)(f.a.mark((function a(r){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e(t.createRetroWalls(r)));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),createRetroBoard:function(){var a=Object(h.a)(f.a.mark((function a(r){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e(t.createRetroBoard(r)));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),refreshRetroWalls:function(){var a=Object(h.a)(f.a.mark((function a(){return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",e(t.refreshRetroWalls()));case 1:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()}}))(lt),ut=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={firebase:I.getInstance(),idToken:""},r.getReferrerUrl=function(){return r.props.location.state?r.props.location.state.referrer:"/"},r.tryGoogleLogin=r.tryGoogleLogin.bind(Object(Ee.a)(r)),r.tryAnonymousLogin=r.tryAnonymousLogin.bind(Object(Ee.a)(r)),r}return Object(l.a)(a,[{key:"tryGoogleLogin",value:function(){var e=this;this.state.firebase.isUserAuthenticated().then((function(t){t||e.state.firebase.authenticateUser().then((function(){e.props.success(),e.props.history.push(e.getReferrerUrl())}))}))}},{key:"tryAnonymousLogin",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.firebase.isUserAuthenticated();case 2:if(e.sent){e.next=4;break}this.state.firebase.authenticateAnonymousUser().then((function(){console.log(t.props.location.state),t.props.success(),t.props.history.push(t.getReferrerUrl())}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return n.a.createElement(C.a,null,n.a.createElement(ne.a,null,n.a.createElement(oe.a,null),n.a.createElement(oe.a,null,n.a.createElement("h2",null,"Login Here!"),n.a.createElement(U.a,{className:"btn btn-block btn-social btn-google",onClick:this.tryGoogleLogin},n.a.createElement("span",{className:"fa fa-google"}),"Sign in with Google"),n.a.createElement(U.a,{className:"btn btn-block btn-social",onClick:this.tryAnonymousLogin},n.a.createElement("span",{className:"fa fa-user"}),"Sign in as Anonymous User")),n.a.createElement(oe.a,null)))}}]),a}(n.a.Component),dt=Object(m.f)(ut),mt=function(e){return Object(r.useEffect)((function(){e.service.logout()}),[e]),n.a.createElement(m.a,{to:"/login"})},pt=function(e){var t=Object(r.useState)(!1),a=Object(ce.a)(t,2),n=a[0],o=a[1],c=function(){return o(!1)},s=Object(r.useState)(""),l=Object(ce.a)(s,2),i=l[0],u=l[1],d=Object(r.useState)({error:!0,msg:""}),m=Object(ce.a)(d,2),p=m[0],f=m[1];return r.createElement(r.Fragment,null,r.createElement(U.a,{variant:"link",onClick:function(){return o(!0)}},r.createElement("i",{className:"fa fa-user-plus fa-lg"})),r.createElement(ie.a,{show:n,onHide:c},r.createElement(ie.a.Header,null,r.createElement("h4",null,"Add New Team Member"),r.createElement(ke.a,{variant:"primary"},e.teamName)),r.createElement(ie.a.Body,null,r.createElement(ye.a,{autoComplete:"disabled",onChange:function(e){f({error:!1,msg:""}),u(e.currentTarget.value)},placeholder:"Enter team member's email address",type:"email"}),p.error?r.createElement("span",{className:"text-danger"},p.msg):r.createElement(r.Fragment,null)),r.createElement(ie.a.Footer,null,r.createElement(U.a,{variant:"primary",onClick:function(){var t;i===(null===(t=I.getInstance().getLoggedInUser())||void 0===t?void 0:t.email)?f({error:!0,msg:"LOL! You cannot add your own email!!!"}):(e.addTeamMember(i),c(),f({error:!1,msg:""}))}},"Add Member"),r.createElement(U.a,{variant:"light",onClick:c},"Cancel"))))},ft=function(e){var t=Object(r.useState)(new g),a=Object(ce.a)(t,2),n=a[0],o=a[1],c=Object(r.useState)(!1),s=Object(ce.a)(c,2),l=s[0],i=s[1],u=function(){return i(!1)},d=function(){e.removeMember(n),u()},m=function(t){return e.team.createdBy===t};return function(){var t;return r.createElement(r.Fragment,null,r.createElement(se.a,null,r.createElement(se.a.Header,null,r.createElement("div",{className:"pull-right"},r.createElement(pt,{teamName:e.team.teamName,addTeamMember:function(t){return function(t,a){e.addTeamMember(t,a)}(e.team,t)}}),m(null===(t=I.getInstance().getLoggedInUser())||void 0===t?void 0:t.uid)?r.createElement(U.a,{onClick:function(){return e.deleteTeam(e.team)},variant:"link",style:{color:"crimson"}},r.createElement("i",{className:"fa fa-lg fa-trash"})):r.createElement(r.Fragment,null)),r.createElement("h4",null,e.team.teamName)),r.createElement(se.a.Body,null,r.createElement(Qe.a,null,e.team.teamMembers.map((function(e,t){var a;return r.createElement(Xe.a,{key:t},r.createElement("div",{style:{marginLeft:"auto !important"}},r.createElement("div",{className:"pull-right"},m(null===(a=I.getInstance().getLoggedInUser())||void 0===a?void 0:a.uid)?r.createElement(U.a,{variant:"link",onClick:function(){return o(e),void i(!0)}}," ",r.createElement("i",{style:{color:"crimson"},className:"fa fa-xs fa-remove"})):r.createElement(r.Fragment,null)),e.displayName," ",r.createElement("br",null),r.createElement("span",{className:"text-muted"},e.email)," ",r.createElement("br",null),m(e.uid)?r.createElement(ke.a,{variant:"primary"},"owner"):r.createElement(ke.a,{variant:"secondary"},"member")))}))))),r.createElement(ie.a,{show:l,onHide:u},r.createElement(ie.a.Body,null,r.createElement("h3",null,"Are you sure you want to remove ",r.createElement("strong",null,n.displayName)," from the Team?")),r.createElement(ie.a.Footer,null,r.createElement(U.a,{onClick:d},"Yes"),r.createElement(U.a,{onClick:u},"Cancel"))))}()},ht=function e(){Object(s.a)(this,e),this.teamId="",this.teamName="",this.teamMembers=[],this.createdBy=""},vt=function(e){var t=Object(r.useState)(!1),a=Object(ce.a)(t,2),n=a[0],o=a[1],c=function(){return o(!1)},s=Object(r.useState)(""),l=Object(ce.a)(s,2),i=l[0],u=l[1];return r.createElement(r.Fragment,null,r.createElement(U.a,{variant:"primary",onClick:function(){return o(!0)}},"Create New Team"),r.createElement(ie.a,{show:n,onHide:c},r.createElement(ie.a.Header,null,r.createElement("h3",null,"Create New Team")),r.createElement(ie.a.Body,null,r.createElement(ye.a,{autoFocus:!0,autoComplete:"disabled",onChange:function(e){u(e.currentTarget.value)},placeholder:"Enter your team name..."})),r.createElement(ie.a.Footer,null,r.createElement(U.a,{variant:"primary",onClick:function(){var t,a=new ht;a.teamName=i,a.teamMembers=[],a.createdBy=null===(t=I.getInstance().getLoggedInUser())||void 0===t?void 0:t.uid,e.createTeam(a),c()}},"Create"),r.createElement(U.a,{variant:"light",onClick:c},"Cancel"))))},bt=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={teams:[]},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){document.title="Teams",this.getMyTeams()}},{key:"getMyTeams",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.teamsService.getMyTeams();case 2:t=e.sent,this.setState({teams:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(ne.a,null,r.createElement(oe.a,{md:4,sm:6},r.createElement("div",{className:"pb-2 mt-4 mb-2 border-bottom"},r.createElement("h3",null,"Create New Team")))),r.createElement(ne.a,null,r.createElement(oe.a,{xs:6,md:4},r.createElement(vt,{createTeam:function(t){return e.createTeam(t)}}))),r.createElement("hr",null),r.createElement(ne.a,null,r.createElement(oe.a,{md:4,sm:6},r.createElement("div",{className:"pb-2 mt-4 mb-2 border-bottom"},r.createElement("h3",null,"Existing Teams")))),r.createElement(ne.a,null,this.state.teams.map((function(t,a){return r.createElement(oe.a,{md:4,key:a},r.createElement(ft,{team:t,removeMember:function(a){e.removeMember(t,a)},addTeamMember:function(t,a){return e.addTeamMember(t,a)},deleteTeam:function(t){return e.deleteTeam(t)}}))}))))}},{key:"createTeam",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Creating new team...",this.state),e.next=3,this.props.teamsService.createNewTeam(t);case 3:a=e.sent,r=[].concat(Object(K.a)(this.state.teams),[a]),this.setState({teams:r});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeMember",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Removing member"),e.prev=1,e.next=4,this.props.teamsService.removeTeamMember(t,a);case 4:r=this.state.teams.map((function(e){return Object(Y.a)(Object(Y.a)({},e),{},{teamMembers:e.teamMembers.filter((function(e){return e.uid!==a.uid}))})})),this.setState({teams:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("Error: "+e.t0.msg,e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"addTeamMember",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r,n,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Adding team member..."),e.prev=1,e.next=4,this.props.teamsService.getTeamMember(a);case 4:return r=e.sent,e.next=7,this.props.teamsService.addTeamMember(t,r);case 7:n=e.sent,o=this.state.teams.map((function(e){return e.teamId===t.teamId?(t.teamMembers=n.teamMembers,t):e})),this.setState({teams:o}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("Team member with the given email is not found!!!");case 15:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"deleteTeam",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.teamsService.deleteTeam(t);case 3:a=this.state.teams.filter((function(e){return e.teamId!==t.teamId})),this.setState({teams:a}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Cannot delete team!");case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}]),a}(r.Component),Et=Object(m.f)(bt),gt=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"createNewTeam",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.post("/teams",t);case 2:if(201!==(a=e.sent).status){e.next=8;break}return e.next=6,j.get(a.headers.location);case 6:return r=e.sent,e.abrupt("return",r.data);case 8:throw Error("Encountered some trouble while trying to create new team!");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"addTeamMember",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.post("/teams/member",{team:t,teamMember:a});case 2:if(201!==(r=e.sent).status){e.next=11;break}return e.next=6,j.get(r.headers.location);case 6:if(200!==(n=e.sent).status){e.next=11;break}return e.next=10,n.data;case 10:return e.abrupt("return",e.sent);case 11:throw Error("Member cannot be added. Response Status: "+r.status);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"removeTeamMember",value:function(){var e=Object(h.a)(f.a.mark((function e(t,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.delete("/teams/".concat(t.teamId,"/member/").concat(a.uid));case 2:if(204===(r=e.sent).status){e.next=5;break}throw Error("error deleting team member. Status: "+r.status);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getTeamMember",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/users",{params:{email:t}});case 2:if(200!==(a=e.sent).status){e.next=5;break}return e.abrupt("return",a.data);case 5:throw Error("No user found! Response Status: "+a.status);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteTeam",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.delete("/teams/".concat(t.teamId));case 2:if(204===(a=e.sent).status){e.next=5;break}throw Error("Encountered problem while deleting the team. Response Status: "+a.status);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMyTeams",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/teams");case 2:if(200!==(t=e.sent).status){e.next=7;break}return e.next=6,t.data;case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();gt.instance=void 0;var yt=gt,Ot=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"createBoardTemplate",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.post("/templates",t);case 2:if(201!==(a=e.sent).status){e.next=8;break}return e.next=6,j.get(a.headers.location);case 6:return r=e.sent,e.abrupt("return",r.data);case 8:throw Error("Cannot create template. There is some error in the backend. Status Code: "+a.status);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBoardTemplates",value:function(){var e=Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get("/templates");case 2:if(200!==(t=e.sent).status){e.next=5;break}return e.abrupt("return",t.data);case 5:throw Error("Error fetching templates. Status: "+t.status);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteBoardTemplate",value:function(){var e=Object(h.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.delete("/templates/".concat(t.templateId));case 2:if(204!==(a=e.sent).status){e.next=5;break}return e.abrupt("return");case 5:throw Error("Error deleting template. Status: "+a.status);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return new e}}]),e}(),kt=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={isLogInFlowExecuted:!1},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return n.a.createElement(J.a,{store:re},n.a.createElement(d.a,null,n.a.createElement(m.b,{exact:!0,path:"/login",component:function(t){return n.a.createElement(V,{success:function(){return e.setState({isLogInFlowExecuted:!0})}},n.a.createElement(dt,{success:function(){return e.setState({isLogInFlowExecuted:!0})}}))}}),n.a.createElement(m.b,{exact:!0,path:"/",component:function(e){return n.a.createElement(M,null,n.a.createElement(ze,Object.assign({},e,{retroBoardService:Ue.getInstance(),templateService:Ot.getInstance()})))}}),n.a.createElement(m.b,{exact:!0,path:"/teams",component:function(e){return n.a.createElement(M,null,n.a.createElement(Et,Object.assign({},e,{teamsService:yt.getInstance()})))}}),n.a.createElement(m.b,{exact:!0,path:"/retro-board/:uid/:retroBoardId",component:function(e){return n.a.createElement(M,null,n.a.createElement(it,Object.assign({},e,{retroBoardService:Ue.getInstance(),teamsService:yt.getInstance()})))}}),n.a.createElement(m.b,{exact:!0,path:"/logout",component:function(e){return n.a.createElement(M,null,n.a.createElement(mt,{service:I.getInstance()}))}})))}}]),a}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(572),a(573),a(574),a(575);c.a.render(n.a.createElement(J.a,{store:re},n.a.createElement(kt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[248,1,2]]]);
//# sourceMappingURL=main.bd589c5e.chunk.js.map